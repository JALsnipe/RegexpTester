angular.module("ui.bootstrap.modal",[]).factory("$$stackedMap",function(){return{createNew:function(){var a=[];return{add:function(b,c){a.push({key:b,value:c})},get:function(c){for(var b=0;b<a.length;b++){if(c==a[b].key){return a[b]}}},keys:function(){var c=[];for(var b=0;b<a.length;b++){c.push(a[b].key)}return c},top:function(){return a[a.length-1]},remove:function(d){var b=-1;for(var c=0;c<a.length;c++){if(d==a[c].key){b=c;break}}return a.splice(b,1)[0]},removeTop:function(){return a.splice(a.length-1,1)[0]},length:function(){return a.length}}}}}).directive("modalBackdrop",["$modalStack","$timeout",function(b,a){return{restrict:"EA",replace:true,templateUrl:"lib/angular-1.2.0/ui/modal/backdrop.html",link:function(e,d,c){a(function(){e.animate=true});e.close=function(f){var g=b.getTop();if(g&&g.value.backdrop&&g.value.backdrop!="static"){f.preventDefault();f.stopPropagation();b.dismiss(g.key,"backdrop click")}}}}}]).directive("modalWindow",["$timeout",function(a){return{restrict:"EA",scope:{index:"@"},replace:true,transclude:true,templateUrl:"lib/angular-1.2.0/ui/modal/window.html",link:function(d,c,b){d.windowClass=b.windowClass||"";a(function(){d.animate=true})}}}]).factory("$modalStack",["$document","$compile","$rootScope","$$stackedMap",function(d,f,j,a){var b,i;var e=j.$new(true);var g=d.find("body").eq(0);var c=a.createNew();var h={};function l(){var m=-1;var o=c.keys();for(var n=0;n<o.length;n++){if(c.get(o[n]).value.backdrop){m=n}}return m}j.$watch(l,function(m){e.index=m});function k(m){var n=c.get(m).value;c.remove(m);n.modalDomEl.remove();if(i&&l()==-1){i.remove();i=undefined}n.modalScope.$destroy()}d.bind("keydown",function(m){var n;if(m.which===27){n=c.top();if(n&&n.value.keyboard){j.$apply(function(){h.dismiss(n.key)})}}});h.open=function(m,n){c.add(m,{deferred:n.deferred,modalScope:n.scope,backdrop:n.backdrop,keyboard:n.keyboard});var p=angular.element("<div modal-window></div>");p.attr("window-class",n.windowClass);p.attr("index",c.length()-1);p.html(n.content);var o=f(p)(n.scope);c.top().value.modalDomEl=o;g.append(o);if(l()>=0&&!i){b=angular.element("<div modal-backdrop></div>");i=f(b)(e);g.append(i)}};h.close=function(n,m){var o=c.get(n);if(o){o.value.deferred.resolve(m);k(n)}};h.dismiss=function(m,n){var o=c.get(m).value;if(o){o.deferred.reject(n);k(m)}};h.getTop=function(){return c.top()};return h}]).provider("$modal",function(){var a={options:{backdrop:true,keyboard:true},$get:["$injector","$rootScope","$q","$http","$templateCache","$controller","$modalStack",function(j,h,d,f,c,b,g){var i={};function e(l){return l.template?d.when(l.template):f.get(l.templateUrl,{cache:c}).then(function(m){return m.data})}function k(m){var l=[];angular.forEach(m,function(o,n){if(angular.isFunction(o)||angular.isArray(o)){l.push(d.when(j.invoke(o)))}});return l}i.open=function(m){var r=d.defer();var p=d.defer();var l={result:r.promise,opened:p.promise,close:function(s){g.close(l,s)},dismiss:function(s){g.dismiss(l,s)}};m=angular.extend({},a.options,m);m.resolve=m.resolve||{};if(!m.template&&!m.templateUrl){throw new Error("One of template or templateUrl options is required.")}var q=d.all([e(m)].concat(k(m.resolve)));q.then(function o(w){var t=(m.scope||h).$new();t.$close=l.close;t.$dismiss=l.dismiss;var v,u={};var s=1;if(m.controller){u.$scope=t;u.$modalInstance=l;angular.forEach(m.resolve,function(y,x){u[x]=w[s++]});v=b(m.controller,u)}g.open(l,{scope:t,deferred:r,content:w[0],backdrop:m.backdrop,keyboard:m.keyboard,windowClass:m.windowClass})},function n(s){r.reject(s)});q.then(function(){p.resolve(true)},function(){p.reject(false)});return l};return i}]};return a});